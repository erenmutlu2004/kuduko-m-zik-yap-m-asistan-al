# .NET Framework'ü yükle
Add-Type -AssemblyName "System.Windows.Forms"
Add-Type -AssemblyName "System.Drawing"

# Formu oluştur
$form = New-Object System.Windows.Forms.Form
$form.Text = "Kuduko Müzik Yapım Asistan Al"
$form.Size = New-Object System.Drawing.Size(500, 350)

# Bir Label ekleyelim
$label = New-Object System.Windows.Forms.Label
$label.Text = "GitHub Repo Komutlarını Çalıştır"
$label.Size = New-Object System.Drawing.Size(250, 20)
$label.Location = New-Object System.Drawing.Point(150, 50)
$form.Controls.Add($label)

# Bir Button ekleyelim (GitHub reposundan dosya indirmek için)
$downloadButton = New-Object System.Windows.Forms.Button
$downloadButton.Text = "GitHub'dan İndir"
$downloadButton.Size = New-Object System.Drawing.Size(150, 30)
$downloadButton.Location = New-Object System.Drawing.Point(175, 100)
$form.Controls.Add($downloadButton)

# GitHub'dan dosya indirme işlevini ekleyelim
$downloadButton.Add_Click({
    $label.Text = "Dosya indiriliyor..."
    
    # GitHub'dan dosya indirmek için
    $repoUrl = "https://github.com/erenmutlu2004/kuduko-m-zik-yap-m-asistan-al/archive/refs/heads/main.zip"
    $destinationPath = "C:\Users\$env:USERNAME\Downloads\kuduko_music_assistant.zip"

    # Dosyayı indir
    Invoke-WebRequest -Uri $repoUrl -OutFile $destinationPath

    # İndirilen dosyayı çıkart
    $extractPath = "C:\Users\$env:USERNAME\Downloads\kuduko_music_assistant"
    Expand-Archive -Path $destinationPath -DestinationPath $extractPath

    $label.Text = "Dosya indirildi ve çıkarıldı!"
})

# Bir Button ekleyelim (İndirilen scripti çalıştırmak için)
$runButton = New-Object System.Windows.Forms.Button
$runButton.Text = "Scripti Çalıştır"
$runButton.Size = New-Object System.Drawing.Size(150, 30)
$runButton.Location = New-Object System.Drawing.Point(175, 150)
$form.Controls.Add($runButton)

# Scripti çalıştırma işlevini ekleyelim
$runButton.Add_Click({
    $label.Text = "Script çalıştırılıyor..."
    
    # İndirilen ve çıkarılan dosyanın yolunu belirleyelim
    $scriptPath = "C:\Users\erenm\Downloads\kuduko_music_assistant.zip"
    
    # PowerShell scriptini çalıştır
    Start-Process powershell -ArgumentList "-File", $scriptPath

    $label.Text = "Script çalıştırıldı!"
})

# Formu göster
$form.ShowDialog()
